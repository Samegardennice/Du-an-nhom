<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Báº£ng Ä‘iá»u khiá»ƒn Quáº£n trá»‹ viÃªn - Green Campus</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='admin.css') }}" />
</head>
<body>
  <header>
    <h1>ğŸŒ¿ Green Campus Admin Dashboard</h1>
    <form action="{{ url_for('logout') }}" method="get">
      <button class="logout-btn" type="submit">ÄÄƒng xuáº¥t</button>
    </form>
  </header>

  <main class="dashboard">
    <!-- ğŸ“Š Khu vá»±c thá»‘ng kÃª -->
    <section class="cards">
      <div class="card">
        <h3>ğŸ‘¥ NgÆ°á»i dÃ¹ng</h3>
        <p class="number">{{ total_users }}</p>
        <p class="desc">Tá»•ng sá»‘ ngÆ°á»i dÃ¹ng Ä‘Ã£ Ä‘Äƒng kÃ½</p>
      </div>
      <div class="card">
        <h3>ğŸŒ± HÃ nh Ä‘á»™ng xanh</h3>
        <p class="number">{{ total_images_all }}</p>
        <p class="desc">Tá»•ng sá»‘ hÃ nh Ä‘á»™ng xanh Ä‘Ã£ ghi nháº­n tá»« ngÆ°á»i dÃ¹ng</p>
      </div>
      <div class="card">
        <h3>âœ… ÄÃ£ xÃ¡c nháº­n</h3>
        <p class="number">{{ total_images_approved }}</p>
        <p class="desc">HÃ nh Ä‘á»™ng xanh Ä‘Æ°á»£c duyá»‡t</p>
      </div>
    </section>
    
    <!-- ğŸ“… Äáº¿m sá»‘ hoáº¡t Ä‘á»™ng Ä‘Ã£ duyá»‡t trong ngÃ y -->
    <section class="count-section">
      <h2>ğŸ“… Thá»‘ng kÃª hoáº¡t Ä‘á»™ng xanh theo ngÃ y</h2>
      <form method="POST" action="{{ url_for('admin_dashboard') }}">
        <label for="selected_date">Chá»n ngÃ y:</label>
        <input type="date" id="selected_date" name="selected_date" required>
        <button type="submit">Xem</button>
      </form>

      {% if selected_date %}
      <p class="result">
        NgÃ y <b>{{ selected_date }}</b> cÃ³ 
        <b>{{ count_by_date or 0 }}</b> hoáº¡t Ä‘á»™ng Ä‘Æ°á»£c duyá»‡t âœ…
      </p>
      {% endif %}
    </section>

    <!-- ğŸ‘¤ Danh sÃ¡ch ngÆ°á»i dÃ¹ng -->
    <section class="user-section">
      <h2>ğŸ‘¤ Danh sÃ¡ch ngÆ°á»i dÃ¹ng</h2>
      <table>
        <thead>
          <tr>
            <th>TÃªn</th>
            <th>Email</th>
            <th>Äá»‹a chá»‰</th>
            <th>SÄT</th>
            <th>Vai trÃ²</th>
          </tr>
        </thead>
        <tbody>
          {% for u in users %}
          <tr>
            <td>{{ u.username }}</td>
            <td>{{ u.email }}</td>
            <td>{{ u.address or '-' }}</td>
            <td>{{ u.phone or '-' }}</td>
            <td>{{ u.role }}</td>
          </tr>
          {% else %}
          <tr><td colspan="5" style="text-align:center;">KhÃ´ng cÃ³ ngÆ°á»i dÃ¹ng nÃ o.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </section>

    <!-- ğŸŒ HÃ nh Ä‘á»™ng xanh chá» xÃ¡c nháº­n -->
    <section class="action-section">
      <h2>ğŸŒ HÃ nh Ä‘á»™ng xanh chá» xÃ¡c nháº­n</h2>
      <table>
        <thead>
          <tr>
            <th>NgÆ°á»i dÃ¹ng</th>
            <th>MÃ´ táº£ hÃ nh Ä‘á»™ng</th>
            <th>áº¢nh minh chá»©ng</th>
            <th>NgÃ y gá»­i</th>
            <th>Thao tÃ¡c</th>
          </tr>
        </thead>
        <tbody>
          {% for img in pending_images %}
          <tr>
            <td>{{ img.username }}</td>
            <td>{{ img.caption }}</td>
            <td>
              <img src="{{ url_for('uploaded_file', filename=img.image_path.split('/')[-1]) }}" 
                   alt="áº£nh hÃ nh Ä‘á»™ng" width="120" />
            </td>
            <td>{{ img.created_at }}</td>
            <td>
              <form action="{{ url_for('approve_photo', image_id=img.id) }}" method="post" style="display:inline;">
                <button class="approve" type="submit">âœ” Duyá»‡t</button>
              </form>
              <form action="{{ url_for('reject_photo', image_id=img.id) }}" method="post" style="display:inline;">
                <button class="reject" type="submit">âœ– Tá»« chá»‘i</button>
              </form>
            </td>
          </tr>
          {% else %}
          <tr><td colspan="5" style="text-align:center;">KhÃ´ng cÃ³ hÃ nh Ä‘á»™ng nÃ o Ä‘ang chá» duyá»‡t.</td></tr>
          {% endfor %}
        </tbody>
      </table>
    </section>
  </main>
</body>
</html>